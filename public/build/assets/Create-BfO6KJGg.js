import{Q as S,l as p,T as E,p as q,f as i,a as v,u as l,w as B,F as b,o as a,Z as D,b as e,t as u,e as F,i as d,y as U,s as g,q as c,k as M,d as T}from"./app-IE8USvGh.js";const I={class:"max-w-6xl mx-auto py-12"},O={class:"bg-white shadow-md rounded-lg p-6"},P={class:"text-2xl font-semibold mb-4"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={class:"mb-4"},L=["disabled"],Q=["value"],Z={class:"mb-4"},z=["disabled"],G={class:"mb-4"},H={class:"mb-4"},J={class:"mb-4"},K={class:"bg-blue-500 text-white text-xs font-medium mr-2 px-2.5 py-0.5 rounded"},W=["onClick"],X=["value"],Y={class:"mb-4"},tt={class:"mt-4"},et=["disabled"],st={class:"mt-4"},rt={__name:"Create",props:{unit:Object},setup(R){var k;const n=R,{properties:h,utilities:w}=S().props,x=p(!1),C=p(!!n.unit),s=E({id:n.unit?n.unit.id:null,property_id:n.unit?n.unit.property_id:"",name:n.unit?n.unit.name:"",rentAmount:n.unit?n.unit.rentAmount:"",taxRate:n.unit?n.unit.taxRate:null,recurringBills:n.unit?n.unit.recurringBills:[],notes:n.unit?n.unit.notes:""}),f=p(new Set(((k=n.unit)==null?void 0:k.recurringBills.map(r=>r.type))||[])),m=p(""),V=async()=>{x.value=!0,s.clearErrors();try{C.value?await s.put(route("units.update",s.id)):await s.post(route("units.store"))}catch(r){r.response&&r.response.data&&r.response.data.errors?s.setError(r.response.data.errors):console.error("An unexpected error occurred:",r)}finally{x.value=!1}},A=r=>{const t=w.data.find(y=>y.id===r);r&&t&&!f.value.has(r)&&(s.recurringBills.push({type:r,name:t.name}),f.value.add(r),m.value="")},N=r=>{const t=s.recurringBills[r].type;s.recurringBills.splice(r,1),f.value.delete(t)};return(r,t)=>{const y=q("app-layout");return a(),i(b,null,[v(l(D),{title:"Create/Edit Unit"}),v(y,null,{default:B(()=>[e("div",I,[e("div",O,[e("h1",P,u(l(s).id?"Edit Unit":"Create Unit"),1),e("form",{onSubmit:F(V,["prevent"])},[e("div",$,[e("div",j,[t[8]||(t[8]=e("label",{for:"propertyId",class:"block text-sm font-medium text-gray-700"},"Select Property",-1)),d(e("select",{id:"property","onUpdate:modelValue":t[0]||(t[0]=o=>l(s).property_id=o),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500",required:"",disabled:l(s).id!==null},[t[7]||(t[7]=e("option",{disabled:"",value:""},"Select Property",-1)),(a(!0),i(b,null,g(l(h).data,o=>(a(),i("option",{key:o.id,value:o.id},u(o.propertyName),9,Q))),128))],8,L),[[U,l(s).property_id]])]),e("div",Z,[t[9]||(t[9]=e("label",{for:"unitName",class:"block text-sm font-medium text-gray-700"},"Unit ID/Name",-1)),d(e("input",{type:"text",id:"unitName",disabled:l(s).property_id=="","onUpdate:modelValue":t[1]||(t[1]=o=>l(s).name=o),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",required:""},null,8,z),[[c,l(s).name]])]),e("div",G,[t[10]||(t[10]=e("label",{for:"rentAmount",class:"block text-sm font-medium text-gray-700"},"Rent Amount",-1)),d(e("input",{type:"number",id:"rentAmount","onUpdate:modelValue":t[2]||(t[2]=o=>l(s).rentAmount=o),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",required:""},null,512),[[c,l(s).rentAmount]])]),e("div",H,[t[11]||(t[11]=e("label",{for:"taxRate",class:"block text-sm font-medium text-gray-700"},"Tax Rate % (optional)",-1)),d(e("input",{type:"number",id:"taxRate","onUpdate:modelValue":t[3]||(t[3]=o=>l(s).taxRate=o),placeholder:"e.g. 7.5 for residential or 16 for commercial",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},null,512),[[c,l(s).taxRate]]),t[12]||(t[12]=e("p",{class:"text-gray-500 text-xs mt-1"}," Residential units tax rate is usually 7.5%. Commercial units tax rate is usually 16%. ",-1))]),e("div",J,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Other Recurring Bills (optional)",-1)),(a(!0),i(b,null,g(l(s).recurringBills,(o,_)=>(a(),i("div",{key:_,class:"flex items-center space-x-2 mb-2"},[e("span",K,u(o.name),1),e("button",{type:"button",onClick:ot=>N(_),class:"text-red-500 hover:text-red-700"}," Remove ",8,W)]))),128)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>m.value=o),onChange:t[5]||(t[5]=o=>A(m.value)),class:"block border border-gray-300 rounded-md shadow-sm p-2"},[t[13]||(t[13]=e("option",{value:""},"Select bill type",-1)),(a(!0),i(b,null,g(l(w).data,o=>(a(),i("option",{key:o.id,value:o.id},u(o.name),9,X))),128))],544),[[U,m.value]])]),e("div",Y,[t[15]||(t[15]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700"},"Notes (optional)",-1)),d(e("textarea",{id:"notes","onUpdate:modelValue":t[6]||(t[6]=o=>l(s).notes=o),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},null,512),[[c,l(s).notes]])])]),e("div",tt,[e("button",{type:"submit",class:"w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600",disabled:x.value},u(l(s).id?"Update Unit":"Create Unit"),9,et)])],32),e("div",st,[v(l(M),{href:"/units",class:"text-blue-500 hover:text-blue-700"},{default:B(()=>t[16]||(t[16]=[T(" Back to Units ")])),_:1})])])])]),_:1})],64)}}};export{rt as default};
