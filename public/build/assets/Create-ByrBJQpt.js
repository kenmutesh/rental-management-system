import{Q as V,l as x,p as N,f as r,a as y,u as p,w as k,F as b,o as n,Z as S,b as t,t as u,e as A,i as d,y as _,s as f,q as v,k as q,d as E}from"./app-C2dyUFtU.js";const D={class:"max-w-6xl mx-auto py-12"},M={class:"bg-white shadow-md rounded-lg p-6"},O={class:"text-2xl font-semibold mb-4"},T={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$={class:"mb-4"},j=["disabled"],F=["value"],I={class:"mb-4"},P=["disabled"],L={class:"mb-4"},Q={class:"mb-4"},Z={class:"mb-4"},z={class:"bg-blue-500 text-white text-xs font-medium mr-2 px-2.5 py-0.5 rounded"},G=["onClick"],H=["value"],J={class:"mb-4"},K={class:"mt-4"},W={type:"submit",class:"w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600"},X={class:"mt-4"},te={__name:"Create",props:{unit:Object},setup(B){const g=B,{properties:U,utilities:w}=V().props,s=x({id:null,property_id:"",name:"",rentAmount:"",taxRate:null,recurringBills:[],notes:""}),c=x(new Set),m=x("");g.unit&&Object.assign(s.value,g.unit.data);const h=async()=>{const o=s.value.id?`/units/${s.value.id}`:"/units",e=s.value.id?"put":"post",i=s.value.recurringBills.map(a=>({type:a.type,name:a.name})),l={...s.value,recurringBills:i};try{await axios[e](o,l)}catch(a){console.error("Error saving unit:",a)}},C=o=>{const e=w.data.find(i=>i.id===o);o&&e&&!c.value.has(o)&&(s.value.recurringBills.push({type:o,name:e.name}),c.value.add(o),m.value="")},R=o=>{const e=s.value.recurringBills[o].type;s.value.recurringBills.splice(o,1),c.value.delete(e)};return(o,e)=>{const i=N("app-layout");return n(),r(b,null,[y(p(S),{title:"Create/Edit Unit"}),y(i,null,{default:k(()=>[t("div",D,[t("div",M,[t("h1",O,u(s.value.id?"Edit Unit":"Create Unit"),1),t("form",{onSubmit:A(h,["prevent"])},[t("div",T,[t("div",$,[e[8]||(e[8]=t("label",{for:"propertyId",class:"block text-sm font-medium text-gray-700"},"Select Property",-1)),d(t("select",{id:"property","onUpdate:modelValue":e[0]||(e[0]=l=>s.value.property_id=l),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500",required:"",disabled:s.value.id!==null},[e[7]||(e[7]=t("option",{disabled:"",value:""},"Select Property",-1)),(n(!0),r(b,null,f(p(U).data,l=>(n(),r("option",{key:l.id,value:l.id},u(l.propertyName),9,F))),128))],8,j),[[_,s.value.property_id]])]),t("div",I,[e[9]||(e[9]=t("label",{for:"unitName",class:"block text-sm font-medium text-gray-700"},"Unit ID/Name",-1)),d(t("input",{type:"text",id:"unitName",disabled:s.value.property_id=="","onUpdate:modelValue":e[1]||(e[1]=l=>s.value.name=l),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",required:""},null,8,P),[[v,s.value.name]])]),t("div",L,[e[10]||(e[10]=t("label",{for:"rentAmount",class:"block text-sm font-medium text-gray-700"},"Rent Amount",-1)),d(t("input",{type:"number",id:"rentAmount","onUpdate:modelValue":e[2]||(e[2]=l=>s.value.rentAmount=l),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",required:""},null,512),[[v,s.value.rentAmount]])]),t("div",Q,[e[11]||(e[11]=t("label",{for:"taxRate",class:"block text-sm font-medium text-gray-700"},"Tax Rate % (optional)",-1)),d(t("input",{type:"number",id:"taxRate","onUpdate:modelValue":e[3]||(e[3]=l=>s.value.taxRate=l),placeholder:"e.g. 7.5 for residential or 16 for commercial",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},null,512),[[v,s.value.taxRate]]),e[12]||(e[12]=t("p",{class:"text-gray-500 text-xs mt-1"}," Residential units tax rate is usually 7.5%. Commercial units tax rate is usually 16%. ",-1))]),t("div",Z,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"Other Recurring Bills (optional)",-1)),(n(!0),r(b,null,f(s.value.recurringBills,(l,a)=>(n(),r("div",{key:a,class:"flex items-center space-x-2 mb-2"},[t("span",z,u(l.name),1),t("button",{type:"button",onClick:Y=>R(a),class:"text-red-500 hover:text-red-700"}," Remove ",8,G)]))),128)),d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>m.value=l),onChange:e[5]||(e[5]=l=>C(m.value)),class:"block border border-gray-300 rounded-md shadow-sm p-2"},[e[13]||(e[13]=t("option",{value:""},"Select bill type",-1)),(n(!0),r(b,null,f(p(w).data,l=>(n(),r("option",{key:l.id,value:l.id},u(l.name),9,H))),128))],544),[[_,m.value]])]),t("div",J,[e[15]||(e[15]=t("label",{for:"notes",class:"block text-sm font-medium text-gray-700"},"Notes (optional)",-1)),d(t("textarea",{id:"notes","onUpdate:modelValue":e[6]||(e[6]=l=>s.value.notes=l),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},null,512),[[v,s.value.notes]])])]),t("div",K,[t("button",W,u(s.value.id?"Update Unit":"Create Unit"),1)])],32),t("div",X,[y(p(q),{href:"/units",class:"text-blue-500 hover:text-blue-700"},{default:k(()=>e[16]||(e[16]=[E(" Back to Units ")])),_:1})])])])]),_:1})],64)}}};export{te as default};
