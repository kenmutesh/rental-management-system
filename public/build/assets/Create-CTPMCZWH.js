import{Q as C,l as m,T as V,C as N,p as S,o as l,f as n,a as k,u as s,w as B,F as b,Z as q,b as r,t as i,e as E,i as u,y as h,s as f,g as v,q as y,k as M,d as D}from"./app-6RKgaJaK.js";const F={class:"max-w-6xl mx-auto py-12"},T={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},I={class:"text-2xl font-semibold mb-4 text-gray-900 dark:text-white"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$={class:"mb-4"},L=["disabled"],O=["value"],Q={key:0,class:"text-red-500 text-sm"},Z={class:"mb-4"},j=["disabled"],z={key:0,class:"text-red-500 text-sm"},G={class:"mb-4"},H={key:0,class:"text-red-500 text-sm"},J={class:"mb-4"},K={class:"mb-4"},W={class:"bg-blue-500 text-white text-xs font-medium mr-2 px-2.5 py-0.5 rounded"},X=["onClick"],Y=["value"],ee={class:"mb-4"},te={class:"mt-4"},re=["disabled"],se={class:"mt-4"},le={__name:"Create",setup(ae){const d=C().props,g=m(!1),_=m(!1),t=V({id:null,property_id:"",name:"",rentAmount:"",taxRate:null,recurringBills:[],notes:""});m({property_id:"",name:"",rentAmount:"",recurringBills:"",taxRate:"",notes:""}),N(()=>{d.unit&&(_.value=!0,t.id=d.unit.data.id,t.property_id=d.unit.data.property_id,t.name=d.unit.data.name,t.rentAmount=d.unit.data.rentAmount,t.taxRate=d.unit.data.taxRate,t.recurringBills=d.unit.data.recurringBills||[],t.notes=d.unit.data.notes)});const x=m(new Set(t.recurringBills.map(o=>o.type))),p=m(""),U=async()=>{g.value=!0,t.errors={};try{_.value?await t.put(route("units.update",t.id)):await t.post(route("units.store"))}catch(o){o.response&&o.response.data&&o.response.data.errors?t.errors=o.response.data.errors:console.error("An unexpected error occurred:",o)}finally{g.value=!1}},R=o=>{const e=d.utilities.data.find(c=>c.id===o);o&&e&&!x.value.has(o)&&(t.recurringBills.push({type:o,name:e.name}),x.value.add(o),p.value="")},A=o=>{const e=t.recurringBills[o].type;t.recurringBills.splice(o,1),x.value.delete(e)};return(o,e)=>{const c=S("app-layout");return l(),n(b,null,[k(s(q),{title:"Create/Edit Unit"}),k(c,null,{default:B(()=>[r("div",F,[r("div",T,[r("h1",I,i(s(t).id?"Edit Unit":"Create Unit"),1),r("form",{onSubmit:E(U,["prevent"])},[r("div",P,[r("div",$,[e[8]||(e[8]=r("label",{for:"propertyId",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Select Property",-1)),u(r("select",{id:"property","onUpdate:modelValue":e[0]||(e[0]=a=>s(t).property_id=a),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:"",disabled:s(t).id!==null},[e[7]||(e[7]=r("option",{disabled:"",value:""},"Select Property",-1)),(l(!0),n(b,null,f(s(d).properties.data,a=>(l(),n("option",{key:a.id,value:a.id},i(a.propertyName),9,O))),128))],8,L),[[h,s(t).property_id]]),s(t).errors.property_id?(l(),n("span",Q,i(s(t).errors.property_id),1)):v("",!0)]),r("div",Z,[e[9]||(e[9]=r("label",{for:"unitName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Unit ID/Name",-1)),u(r("input",{type:"text",id:"unitName",disabled:s(t).property_id==="","onUpdate:modelValue":e[1]||(e[1]=a=>s(t).name=a),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:""},null,8,j),[[y,s(t).name]]),s(t).errors.name?(l(),n("span",z,i(s(t).errors.name),1)):v("",!0)]),r("div",G,[e[10]||(e[10]=r("label",{for:"rentAmount",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Rent Amount",-1)),u(r("input",{type:"number",id:"rentAmount","onUpdate:modelValue":e[2]||(e[2]=a=>s(t).rentAmount=a),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:""},null,512),[[y,s(t).rentAmount]]),s(t).errors.rentAmount?(l(),n("span",H,i(s(t).errors.rentAmount),1)):v("",!0)]),r("div",J,[e[11]||(e[11]=r("label",{for:"taxRate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tax Rate % (optional)",-1)),u(r("input",{type:"number",id:"taxRate","onUpdate:modelValue":e[3]||(e[3]=a=>s(t).taxRate=a),placeholder:"e.g. 7.5 for residential or 16 for commercial",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},null,512),[[y,s(t).taxRate]]),e[12]||(e[12]=r("p",{class:"text-gray-500 text-xs mt-1 dark:text-gray-400"}," Residential units tax rate is usually 7.5%. Commercial units tax rate is usually 16%. ",-1))]),r("div",K,[e[14]||(e[14]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Other Recurring Bills (optional)",-1)),(l(!0),n(b,null,f(s(t).recurringBills,(a,w)=>(l(),n("div",{key:w,class:"flex items-center space-x-2 mb-2"},[r("span",W,i(a.name),1),r("button",{type:"button",onClick:oe=>A(w),class:"text-red-500 hover:text-red-700"}," Remove ",8,X)]))),128)),u(r("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>p.value=a),onChange:e[5]||(e[5]=a=>R(p.value)),class:"block border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},[e[13]||(e[13]=r("option",{value:""},"Select bill type",-1)),(l(!0),n(b,null,f(s(d).utilities.data,a=>(l(),n("option",{key:a.id,value:a.id},i(a.name),9,Y))),128))],544),[[h,p.value]])]),r("div",ee,[e[15]||(e[15]=r("label",{for:"notes",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Notes (optional)",-1)),u(r("textarea",{id:"notes","onUpdate:modelValue":e[6]||(e[6]=a=>s(t).notes=a),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},null,512),[[y,s(t).notes]])])]),r("div",te,[r("button",{type:"submit",class:"w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:g.value},i(s(t).id?"Update Unit":"Create Unit"),9,re)])],32),r("div",se,[k(s(M),{href:"/units",class:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-500"},{default:B(()=>e[16]||(e[16]=[D(" Back to Units ")])),_:1})])])])]),_:1})],64)}}};export{le as default};
