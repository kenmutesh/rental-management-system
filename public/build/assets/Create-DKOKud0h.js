import{Q as S,l as p,T as E,p as q,o as l,f as n,a as k,u as o,w as B,F as b,Z as D,b as e,t as u,e as F,i,y as U,s as f,q as g,k as M,d as T}from"./app-BtpFdyZw.js";const I={class:"max-w-6xl mx-auto py-12"},O={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},P={class:"text-2xl font-semibold mb-4 text-gray-900 dark:text-white"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={class:"mb-4"},L=["disabled"],Q=["value"],Z={class:"mb-4"},z=["disabled"],G={class:"mb-4"},H={class:"mb-4"},J={class:"mb-4"},K={class:"bg-blue-500 text-white text-xs font-medium mr-2 px-2.5 py-0.5 rounded"},W=["onClick"],X=["value"],Y={class:"mb-4"},tt={class:"mt-4"},et=["disabled"],rt={class:"mt-4"},at={__name:"Create",props:{unit:Object},setup(h){var w;const d=h,{properties:R,utilities:v}=S().props,y=p(!1),C=p(!!d.unit),r=E({id:d.unit?d.unit.id:null,property_id:d.unit?d.unit.property_id:"",name:d.unit?d.unit.name:"",rentAmount:d.unit?d.unit.rentAmount:"",taxRate:d.unit?d.unit.taxRate:null,recurringBills:d.unit?d.unit.recurringBills:[],notes:d.unit?d.unit.notes:""}),x=p(new Set(((w=d.unit)==null?void 0:w.recurringBills.map(a=>a.type))||[])),m=p(""),V=async()=>{y.value=!0,r.clearErrors();try{C.value?await r.put(route("units.update",r.id)):await r.post(route("units.store"))}catch(a){a.response&&a.response.data&&a.response.data.errors?r.setError(a.response.data.errors):console.error("An unexpected error occurred:",a)}finally{y.value=!1}},A=a=>{const t=v.data.find(c=>c.id===a);a&&t&&!x.value.has(a)&&(r.recurringBills.push({type:a,name:t.name}),x.value.add(a),m.value="")},N=a=>{const t=r.recurringBills[a].type;r.recurringBills.splice(a,1),x.value.delete(t)};return(a,t)=>{const c=q("app-layout");return l(),n(b,null,[k(o(D),{title:"Create/Edit Unit"}),k(c,null,{default:B(()=>[e("div",I,[e("div",O,[e("h1",P,u(o(r).id?"Edit Unit":"Create Unit"),1),e("form",{onSubmit:F(V,["prevent"])},[e("div",$,[e("div",j,[t[8]||(t[8]=e("label",{for:"propertyId",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Select Property",-1)),i(e("select",{id:"property","onUpdate:modelValue":t[0]||(t[0]=s=>o(r).property_id=s),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:"",disabled:o(r).id!==null},[t[7]||(t[7]=e("option",{disabled:"",value:""},"Select Property",-1)),(l(!0),n(b,null,f(o(R).data,s=>(l(),n("option",{key:s.id,value:s.id},u(s.propertyName),9,Q))),128))],8,L),[[U,o(r).property_id]])]),e("div",Z,[t[9]||(t[9]=e("label",{for:"unitName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Unit ID/Name",-1)),i(e("input",{type:"text",id:"unitName",disabled:o(r).property_id=="","onUpdate:modelValue":t[1]||(t[1]=s=>o(r).name=s),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:""},null,8,z),[[g,o(r).name]])]),e("div",G,[t[10]||(t[10]=e("label",{for:"rentAmount",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Rent Amount",-1)),i(e("input",{type:"number",id:"rentAmount","onUpdate:modelValue":t[2]||(t[2]=s=>o(r).rentAmount=s),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:""},null,512),[[g,o(r).rentAmount]])]),e("div",H,[t[11]||(t[11]=e("label",{for:"taxRate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tax Rate % (optional)",-1)),i(e("input",{type:"number",id:"taxRate","onUpdate:modelValue":t[3]||(t[3]=s=>o(r).taxRate=s),placeholder:"e.g. 7.5 for residential or 16 for commercial",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},null,512),[[g,o(r).taxRate]]),t[12]||(t[12]=e("p",{class:"text-gray-500 text-xs mt-1 dark:text-gray-400"}," Residential units tax rate is usually 7.5%. Commercial units tax rate is usually 16%. ",-1))]),e("div",J,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Other Recurring Bills (optional)",-1)),(l(!0),n(b,null,f(o(r).recurringBills,(s,_)=>(l(),n("div",{key:_,class:"flex items-center space-x-2 mb-2"},[e("span",K,u(s.name),1),e("button",{type:"button",onClick:st=>N(_),class:"text-red-500 hover:text-red-700"}," Remove ",8,W)]))),128)),i(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>m.value=s),onChange:t[5]||(t[5]=s=>A(m.value)),class:"block border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},[t[13]||(t[13]=e("option",{value:""},"Select bill type",-1)),(l(!0),n(b,null,f(o(v).data,s=>(l(),n("option",{key:s.id,value:s.id},u(s.name),9,X))),128))],544),[[U,m.value]])]),e("div",Y,[t[15]||(t[15]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Notes (optional)",-1)),i(e("textarea",{id:"notes","onUpdate:modelValue":t[6]||(t[6]=s=>o(r).notes=s),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},null,512),[[g,o(r).notes]])])]),e("div",tt,[e("button",{type:"submit",class:"w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:y.value},u(o(r).id?"Update Unit":"Create Unit"),9,et)])],32),e("div",rt,[k(o(M),{href:"/units",class:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-500"},{default:B(()=>t[16]||(t[16]=[T(" Back to Units ")])),_:1})])])])]),_:1})],64)}}};export{at as default};
