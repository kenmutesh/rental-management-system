import{Q as C,l as p,T as A,C as V,p as N,o as l,f as n,a as k,u as s,w as _,F as b,Z as S,b as r,t as u,e as q,i,y as B,s as f,q as g,k as E,d as M}from"./app-DBZLbXD_.js";const D={class:"max-w-6xl mx-auto py-12"},F={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},T={class:"text-2xl font-semibold mb-4 text-gray-900 dark:text-white"},I={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},P={class:"mb-4"},$=["disabled"],L=["value"],O={class:"mb-4"},Q=["disabled"],Z={class:"mb-4"},j={class:"mb-4"},z={class:"mb-4"},G={class:"bg-blue-500 text-white text-xs font-medium mr-2 px-2.5 py-0.5 rounded"},H=["onClick"],J=["value"],K={class:"mb-4"},W={class:"mt-4"},X=["disabled"],Y={class:"mt-4"},at={__name:"Create",setup(tt){const d=C().props,y=p(!1),v=p(!1),e=A({id:null,property_id:"",name:"",rentAmount:"",taxRate:null,recurringBills:[],notes:"",errors:{}});V(()=>{d.unit&&(v.value=!0,e.id=d.unit.data.id,e.property_id=d.unit.data.property_id,e.name=d.unit.data.name,e.rentAmount=d.unit.data.rentAmount,e.taxRate=d.unit.data.taxRate,e.recurringBills=d.unit.data.recurringBills||[],e.notes=d.unit.data.notes)});const x=p(new Set(e.recurringBills.map(o=>o.type))),m=p(""),U=async()=>{y.value=!0,e.errors={};try{v.value?await e.put(route("units.update",e.id)):await e.post(route("units.store"))}catch(o){o.response&&o.response.data&&o.response.data.errors?e.errors=o.response.data.errors:console.error("An unexpected error occurred:",o)}finally{y.value=!1}},h=o=>{const t=d.utilities.data.find(c=>c.id===o);o&&t&&!x.value.has(o)&&(e.recurringBills.push({type:o,name:t.name}),x.value.add(o),m.value="")},R=o=>{const t=e.recurringBills[o].type;e.recurringBills.splice(o,1),x.value.delete(t)};return(o,t)=>{const c=N("app-layout");return l(),n(b,null,[k(s(S),{title:"Create/Edit Unit"}),k(c,null,{default:_(()=>[r("div",D,[r("div",F,[r("h1",T,u(s(e).id?"Edit Unit":"Create Unit"),1),r("form",{onSubmit:q(U,["prevent"])},[r("div",I,[r("div",P,[t[8]||(t[8]=r("label",{for:"propertyId",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Select Property",-1)),i(r("select",{id:"property","onUpdate:modelValue":t[0]||(t[0]=a=>s(e).property_id=a),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:"",disabled:s(e).id!==null},[t[7]||(t[7]=r("option",{disabled:"",value:""},"Select Property",-1)),(l(!0),n(b,null,f(s(d).properties.data,a=>(l(),n("option",{key:a.id,value:a.id},u(a.propertyName),9,L))),128))],8,$),[[B,s(e).property_id]])]),r("div",O,[t[9]||(t[9]=r("label",{for:"unitName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Unit ID/Name",-1)),i(r("input",{type:"text",id:"unitName",disabled:s(e).property_id==="","onUpdate:modelValue":t[1]||(t[1]=a=>s(e).name=a),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:""},null,8,Q),[[g,s(e).name]])]),r("div",Z,[t[10]||(t[10]=r("label",{for:"rentAmount",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Rent Amount",-1)),i(r("input",{type:"number",id:"rentAmount","onUpdate:modelValue":t[2]||(t[2]=a=>s(e).rentAmount=a),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300",required:""},null,512),[[g,s(e).rentAmount]])]),r("div",j,[t[11]||(t[11]=r("label",{for:"taxRate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tax Rate % (optional)",-1)),i(r("input",{type:"number",id:"taxRate","onUpdate:modelValue":t[3]||(t[3]=a=>s(e).taxRate=a),placeholder:"e.g. 7.5 for residential or 16 for commercial",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},null,512),[[g,s(e).taxRate]]),t[12]||(t[12]=r("p",{class:"text-gray-500 text-xs mt-1 dark:text-gray-400"}," Residential units tax rate is usually 7.5%. Commercial units tax rate is usually 16%. ",-1))]),r("div",z,[t[14]||(t[14]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Other Recurring Bills (optional)",-1)),(l(!0),n(b,null,f(s(e).recurringBills,(a,w)=>(l(),n("div",{key:w,class:"flex items-center space-x-2 mb-2"},[r("span",G,u(a.name),1),r("button",{type:"button",onClick:et=>R(w),class:"text-red-500 hover:text-red-700"}," Remove ",8,H)]))),128)),i(r("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>m.value=a),onChange:t[5]||(t[5]=a=>h(m.value)),class:"block border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},[t[13]||(t[13]=r("option",{value:""},"Select bill type",-1)),(l(!0),n(b,null,f(s(d).utilities.data,a=>(l(),n("option",{key:a.id,value:a.id},u(a.name),9,J))),128))],544),[[B,m.value]])]),r("div",K,[t[15]||(t[15]=r("label",{for:"notes",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Notes (optional)",-1)),i(r("textarea",{id:"notes","onUpdate:modelValue":t[6]||(t[6]=a=>s(e).notes=a),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},null,512),[[g,s(e).notes]])])]),r("div",W,[r("button",{type:"submit",class:"w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:y.value},u(s(e).id?"Update Unit":"Create Unit"),9,X)])],32),r("div",Y,[k(s(E),{href:"/units",class:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-500"},{default:_(()=>t[16]||(t[16]=[M(" Back to Units ")])),_:1})])])])]),_:1})],64)}}};export{at as default};
